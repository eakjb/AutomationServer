$(".button-collapse").sideNav(),angular.module("com.eakjb.homeAutomation",["ngResource"]).factory("APIInterceptor",["$q",function(a){return{response:function(a){return a.data.isWrapped&&a.data.data&&(a.data=a.data.data),a}}}]).config(["$httpProvider",function(a){a.interceptors.push("APIInterceptor")}]).service("API",["$location","$resource",function(a,b){this.HAL="//"+(a.search().HAL||"192.168.0.137"),this.Node=b(this.HAL+"/api/v1/Nodes/:node_id"),this.nodes=this.Node.query(),this.nodes.$promise.then(function(a){angular.forEach(a,function(a){a.Info=b(a.address,{}),a.Input=b(a.address+"/inputs/:input_id"),a.Output=b(a.address+"/outputs/:output_id",{output_id:"@output_id"},{pushState:{method:"PUT",url:a.address+"/outputs/:output_id/state"}})})})}]).controller("NodeListController",["$scope","$q","API",function(a,b,c){a.nodes=[],a.loaded=!1,a.error=!1,c.nodes.$promise.then(function(c){angular.forEach(c,function(c){var d=c.Info.get();d.$promise.then(function(){},function(a){d.error=a.data});var e=function(){a.loaded=!1;var f=[];d.outputs&&(d.outputs=c.Output.query(),d.outputs.$promise.then(function(b){angular.forEach(b,function(b){b._update=function(d){var f=b.states;"object"==typeof f&&(f=[],angular.forEach(b.states,function(a){f.push(a)})),b.state=f.filter(function(a){return a[d]===b.state[d]})[0],a.loaded=!1,c.Output.pushState({output_id:b.output_id,value:b.state.value}).$promise.then(e,e)}})}),f.push(d.outputs.$promise)),d.inputs&&(d.inputs=c.Input.query(),d.inputs.$promise.then(function(a){angular.forEach(a,function(a){a._style={width:a.value/(a.max-a.min)*100+"%"}})}),f.push(d.inputs.$promise)),b.all(f).then(function(){console.log(d),a.loaded=!0,d.error=!1},function(b){console.log("Error",b),a.loaded=!0,d.error=b.data})};d.$promise.then(e),a.nodes.push(d)})},function(b){a.error=b})}]);